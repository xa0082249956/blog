---
title: 利用位运算枚举所有子集
date: 2017-09-17 23:23:54
tags:
- 位运算
categories:
- coding
- algorithm
---

#### 代码

```c++
for (auto x(rua); x; x = (x - 1) & rua)
{
    ...;
}
```

<!-- more -->

#### 原理

给集合里的元素一个顺序，那么就可以用整数表示集合，某一位为 $1$ 表示对应元素被选取。

设 $x$ 为表示集合的整数，那么这个整数有如下性质：\
 $x$ 的子集整数 $y$ 在数值上不会比 $x$ 大。因为 $x$ 的子集 $y$ 只是保留了 $x$ 某些位置上的 $1$ ，所以 $y$ 总可以加上一个非负的整数 $z$ 等于 $x$ ，相当于把没选的 $1$ 补上。

根据这个性质可知，可以通过枚举所有比 $x$ 小的数 $p$ 并判断， $p$ 是否只含 $x$ 对应位上的 $1$ ，如果是则 $p$ 是 $x$ 的子集，否则不是。这样时间复杂度是严格的 $x$ 。

有没有更快的呢，有的。\
上述枚举 $p$ 是通过减一操作，并且我们知道减一操作一定是正确的，那么在枚举的时候如何快速的去掉多余的状态，答案就是和 $x$ 进行&（与）运算。与运算可以快速跳到下一个子集。\
`&`运算本质就是保留 $p$ 在 $x$ 对应位为 $1$ 的数值，而根据二进制减法可知减一操作都是把 $p$ 最低位的 $1$ 消去，在那一位后全补上 $1$ ，如果在 $x$ 对应位为0的地方产生了 $1$ 其实是无效的，后续的减一操作也会把它消掉，所以直接&运算可以快速去掉多余的状态。时间复杂度是 $x$ 的子集数。

#### 参考

- <http://blog.csdn.net/mtrix/article/details/61200302>
- <http://www.cnblogs.com/jffifa/archive/2012/01/16/2323999.html>
